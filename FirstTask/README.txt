Это моё решение задачи YabdexCup 22 в разделе аналитика-марафон.
См: https://contest.yandex.ru/contest/42200/problems/